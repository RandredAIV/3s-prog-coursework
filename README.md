# AVRAMCHUK BOLID MOTORSPORT 🏎️

> Веб-приложение для просмотра каталога болидов Формулы-1,
> оформления заявок на покупку и управления системой через административную панель.
>
> Репозиторий: https://github.com/Randred/CourseWork

---

## 📋 О проекте

AVRAMCHUK BOLID MOTORSPORT — полноценное веб-приложение для условного автосалона
спортивных болидов Formula 1. Система позволяет пользователям просматривать каталог
болидов прошлых сезонов, фильтровать их по параметрам, добавлять в корзину и
оформлять заявки на покупку. Администратор управляет каталогом, пользователями
и заявками через отдельную административную панель.

Визуальный стиль: минималистичный интерфейс в спортивной стилистике Formula 1,
тёмная палитра с красными акцентными элементами.

---

## ⚙️ Стек технологий
```
Backend          │ Java 17, Spring Boot
Frontend         │ HTML, CSS, JavaScript, Thymeleaf
База данных      │ PostgreSQL 15 / 16
Сборка           │ Maven
Контейнеризация  │ Docker, Docker Compose
Безопасность     │ Spring Security, BCrypt
ORM              │ Spring Data JPA, Hibernate
```

---

## 📦 Зависимости Maven
```
spring-boot-starter-web          │ Обработка HTTP-запросов, MVC-логика
spring-boot-starter-thymeleaf    │ Серверная генерация HTML-страниц
spring-boot-starter-data-jpa     │ Доступ к БД через JPA и Hibernate
spring-boot-starter-security     │ Аутентификация и авторизация
spring-boot-starter-validation   │ Валидация форм (@NotNull, @Size, @Min, @Max)
spring-boot-starter-test         │ Модуль тестирования
postgresql                       │ JDBC-драйвер для PostgreSQL
bcrypt                           │ Безопасное хэширование паролей
```

Все зависимости подтягиваются автоматически через Maven при первом запуске —
вручную ничего скачивать не нужно.

---

## 💻 Что нужно установить перед запуском

Для работы приложения необходимо установить четыре инструмента.
Ниже — пошаговые инструкции для каждого.

---

### 1. Java Development Kit (JDK 17+)

JDK — среда выполнения для Java-приложений. Без неё сервер не запустится.

**Linux (Ubuntu/Debian):**
```
sudo apt update
sudo apt install openjdk-17-jdk -y
```

**Проверка установки:**
```
java -version
```
Должно появиться: `openjdk version "17.x.x"`

**Windows:**
Скачать установщик с официального сайта: https://adoptium.net
Выбрать: Temurin 17 (LTS) → Windows → .msi → установить с галочкой "Add to PATH"

**Проверка (в cmd или PowerShell):**
```
java -version
```

---

### 2. Maven

Maven — система сборки проекта. Нужна для компиляции и запуска Spring Boot.

**Linux (Ubuntu/Debian):**
```
sudo apt install maven -y
```

**Проверка:**
```
mvn -version
```
Должно появиться: `Apache Maven 3.x.x`

**Windows:**
Скачать архив с официального сайта: https://maven.apache.org/download.cgi
Распаковать, добавить папку bin/ в переменную среды PATH.

**Проверка:**
```
mvn -version
```

---

### 3. Docker

Docker — платформа для запуска контейнеров. Нужна для запуска базы данных PostgreSQL.

**Linux (Ubuntu/Debian):**
```
sudo apt update
sudo apt install docker.io -y
sudo systemctl start docker
sudo systemctl enable docker
```

Добавить текущего пользователя в группу docker (чтобы не писать sudo):
```
sudo usermod -aG docker $USER
```
После этой команды необходимо перезайти в систему (logout/login).

**Проверка:**
```
docker --version
```
Должно появиться: `Docker version 24.x.x`

**Windows:**
Скачать Docker Desktop: https://www.docker.com/products/docker-desktop
Установить и запустить. Docker Desktop включает в себя и Docker Compose.

---

### 4. Docker Compose

Docker Compose — инструмент для управления несколькими контейнерами.
Нужен для поднятия контейнера с PostgreSQL одной командой.

**Linux (Ubuntu/Debian):**
```
sudo apt install docker-compose -y
```

**Проверка:**
```
docker-compose --version
```

**Windows:**
Docker Compose уже входит в состав Docker Desktop — отдельно устанавливать не нужно.

---

### 5. PostgreSQL (опционально)

Устанавливать PostgreSQL напрямую не обязательно — база данных запускается
автоматически в Docker-контейнере. Но если хочется работать с БД через
консоль psql или графический клиент pgAdmin — установить можно:

**Linux:**
```
sudo apt install postgresql postgresql-contrib -y
```

**pgAdmin (графический интерфейс для PostgreSQL):**
```
curl https://www.pgadmin.org/static/packages_pgadmin_org.pub | sudo apt-key add
sudo sh -c 'echo "deb https://ftp.postgresql.org/pub/pgadmin/pgadmin4/apt/$(lsb_release -cs) pgadmin4 main" > /etc/apt/sources.list.d/pgadmin4.list && apt update'
sudo apt install pgadmin4 -y
```

---

## 🚀 Запуск проекта — пошаговая инструкция

### Шаг 1 — Клонировать репозиторий
```
git clone https://github.com/Randred/CourseWork
cd CourseWork
```

Если git не установлен:
```
sudo apt install git -y       # Linux
```
На Windows скачать с: https://git-scm.com/download/win

---

### Шаг 2 — Перейти в папку с проектом
```
cd autosalon-web
```

Именно в этой папке находится файл docker-compose.yml и pom.xml.

---

### Шаг 3 — Запустить контейнер базы данных PostgreSQL
```
docker-compose up -d
```

Флаг `-d` запускает контейнер в фоновом режиме.

После выполнения команды автоматически происходит:
- скачивается образ PostgreSQL (при первом запуске)
- создаётся база данных приложения
- настраиваются параметры подключения (имя БД, пользователь, пароль)
- инициализируются таблицы

Проверить, что контейнер запущен:
```
docker ps
```
В списке должен отображаться контейнер с образом postgres.

---

### Шаг 4 — Настройка подключения к базе данных

Параметры подключения к БД хранятся в файле:
```
src/main/resources/application.yml
```

Убедитесь, что параметры совпадают с теми, что указаны в docker-compose.yml:
```
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/autosalon
    username: postgres
    password: ваш_пароль
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
```

Если параметры в docker-compose.yml отличаются — приведите application.yml в соответствие.

---

### Шаг 5 — Запустить серверную часть (Spring Boot)

**Вариант A — через Maven (рекомендуется):**
```
mvn spring-boot:run
```

Maven автоматически скачает все зависимости и запустит приложение.
При первом запуске загрузка зависимостей может занять несколько минут.

**Вариант Б — через скомпилированный JAR:**
```
mvn clean package
java -jar target/autosalon-web-0.0.1-SNAPSHOT.jar
```

---

### Шаг 6 — Открыть приложение в браузере
```
http://localhost:8080
```

Поддерживаемые браузеры: Google Chrome, Mozilla Firefox, Yandex Browser, Opera, Edge.

---

### Шаг 7 — Остановить контейнер (когда закончили работу)
```
docker-compose down
```

---

## 🗂️ Архитектура проекта
```
com.coursework.autosalon.web
│
├── model/                          # Доменные сущности (JPA-классы)
│   ├── User                        # Пользователь
│   ├── Car                         # Болид
│   ├── Team                        # Команда F1
│   ├── Driver                      # Гонщик
│   ├── UserCartItem                # Элемент корзины
│   └── PurchaseRequest             # Заявка на покупку
│
├── repository/                     # Слой доступа к данным (Spring Data JPA)
│   ├── UserRepository
│   ├── CarRepository
│   ├── TeamRepository
│   ├── DriverRepository
│   ├── UserCartRepository
│   └── PurchaseRequestRepository
│
├── service/                        # Бизнес-логика приложения
│   ├── Регистрация и валидация пользователей
│   ├── Фильтрация и поиск болидов
│   ├── Управление корзиной
│   ├── Оформление и обработка заявок
│   └── Проверка возможности удаления болида
│
├── controller/                     # Веб-контроллеры
│   ├── AuthController              # /login, /register
│   ├── CarController               # Каталог, карточка болида
│   ├── CartController              # /cart/add, /cart/remove
│   ├── OrderController             # /checkout
│   ├── AdminCarController          # CRUD болидов (ADMIN)
│   ├── AdminUserController         # Управление пользователями (ADMIN)
│   └── AdminRequestController      # Управление заявками (ADMIN)
│
├── config/                         # Конфигурация Spring Security
└── security/                       # Механизм авторизации и сессий

src/main/resources/
├── templates/                      # HTML-шаблоны Thymeleaf
│   ├── index.html                  # Главная страница
│   ├── login.html                  # Страница входа
│   ├── register.html               # Регистрация
│   ├── catalog.html                # Каталог с фильтрами
│   ├── car-card.html               # Карточка болида
│   ├── cart.html                   # Корзина
│   ├── checkout.html               # Оформление заявки
│   └── admin/                      # Административные страницы
├── application.yml                 # Настройки приложения и БД
└── docker-compose.yml              # Конфигурация Docker-контейнера PostgreSQL
```

---

## 🗃️ База данных
```
users                    # Пользователи системы
├── id
├── фамилия, имя, отчество
├── email
├── password_hash          # Только BCrypt-хэш
├── телефон, дата_рождения, пол
└── role                   # USER или ADMIN

cars                     # Болиды
├── id, название, описание, изображение
├── сезон, цена, статус_наличия
├── team_id  ──────────────────────► teams.id
└── driver_id ─────────────────────► drivers.id

teams                    # Команды Formula 1
└── id, название, страна, основатель, год_основания

drivers                  # Гонщики
└── id, имя, национальность, team_id ──► teams.id

user_cart_items          # Корзина пользователя
├── user_id ────────────────────────► users.id
└── car_id  ────────────────────────► cars.id

purchase_requests        # Заявки на покупку
├── id, номер_заявки, дата, статус
├── цена_снимок            # Зафиксированная цена на момент заявки
├── user_id ────────────────────────► users.id
└── car_id  ────────────────────────► cars.id
```

> ⚠️ Удалить болид нельзя, пока он есть в активных заявках или корзине.
> Это защищено на уровне бизнес-логики сервера.

---

## 🔐 Безопасность
```
BCrypt-хэширование       │ Пароли хранятся только в виде хэшей
Ролевое разграничение    │ Роли USER и ADMIN — admin-маршруты закрыты для пользователей
SQL-инъекции             │ JPA/Hibernate использует параметризованные запросы
XSS                      │ Thymeleaf автоматически экранирует вывод данных
Привязка к user_id       │ Пользователь управляет только своей корзиной и заявками
Переменные среды         │ Пароли БД задаются через ENV, не хранятся в исходниках
Docker-изоляция          │ PostgreSQL доступна только по локальному порту
Журналирование           │ Все обращения к защищённым ресурсам логируются
Сессии                   │ Завершение по /logout
```

---

## 👤 Роли пользователей

### Пользователь (USER)
```
Регистрация:
  → Ввести ФИО, дату рождения, телефон, пол, email, пароль
  → Нажать «Зарегистрироваться» → редирект на страницу входа

Авторизация:
  → Ввести email и пароль → нажать «Войти»
  → Автоматически открывается каталог болидов

Каталог:
  → Настроить фильтры: сезон, производитель, цена, наличие
  → Нажать «Применить фильтр»
  → Нажать «Подробнее» на нужном болиде

Карточка болида:
  → Просмотр характеристик, цены и изображения
  → Нажать «Добавить в корзину»
  → Нажать «Каталог» для возврата

Корзина:
  → Просмотр добавленных болидов
  → Удалить позицию → «Удалить»
  → Очистить всё → «Очистить заявку»
  → Вернуться → «Продолжить покупки»
  → Оформить → «Оформить заявку»

После оформления заявки:
  → Фиксируется модель, цена, дата, номер заявки
  → Статус болида меняется на «Недоступен»
  → Корзина очищается
  → Отображается уведомление об успешной отправке

Выход:
  → Нажать «Выйти» → сессия завершается → главная страница
```

### Администратор (ADMIN)
```
Все возможности USER, плюс:

Каталог:
  → Просмотр скрытых болидов
  → Добавление нового болида (все поля)
  → Редактирование (цена, описание, сезон, изображение)
  → Удаление (только если нет активных заявок)

Пользователи:
  → Полный список пользователей
  → Карточка пользователя с историей заказов

Заявки:
  → Просмотр всех заявок системы
  → Удаление позиций (недоступно для завершённых заявок)
  → Завершение заявки → болид освобождается для удаления
```

---

## 💬 Системные сообщения
```
Ситуация                                  │ Реакция системы
──────────────────────────────────────────┼────────────────────────────────────────
Неверный email или пароль                 │ Ошибка авторизации, предложение повторить
Болид уже в корзине                       │ Предупреждение о дублировании
Болид недоступен для покупки              │ Статус «Недоступен» / «Продан»
Успешное оформление заявки                │ Уведомление с номером и датой заявки
Удаление болида с активной заявкой        │ Отказ с сообщением об ошибке
Нет соединения с БД                       │ Сообщение о недоступности сервиса
Некорректные данные в форме               │ Подсветка полей с ошибками и подсказки
```

---

## ⚡ Нефункциональные характеристики
```
Производительность   │ Загрузка страницы — не более 3 секунд при стандартной нагрузке
Сохранность данных   │ Корзина хранится в БД — не исчезает при перезагрузке сервера
Отказоустойчивость   │ При потере соединения с БД отображается информативное сообщение
Масштабируемость     │ Архитектура позволяет расширять функционал без переработки системы
Поддерживаемость     │ Слоистая архитектура упрощает сопровождение и доработку
```
